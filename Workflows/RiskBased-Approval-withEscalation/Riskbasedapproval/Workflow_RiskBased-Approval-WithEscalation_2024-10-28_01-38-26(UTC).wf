{"JSONDATA":{"modules":[{"config":{"position":[7,15]},"moduleId":0,"name":"Start","value":{}},{"config":{"position":[13,83]},"moduleId":1,"name":"TASK : Manager Approval","value":{"mitigatingControlRisk":[],"name":"Manager Approval Level 1","nottemplate1":"KHC-AccessRequest-ApprovalNotify","nottemplate2":"Select Email Template","reminderdate1":"2 minutes","remindertemplate1":"KHC-AccessRequest-ApprovalNotify-Reminder","removeitemcf":true}},{"config":{"position":[29,679]},"moduleId":2,"name":"CONDITION : If Else","value":{"Condition":"((entitlement!= null and entitlement.risk > 2) and (entitlement.getOwnerRank1().contains(manager.username) == false))","explang":"groovy","name":"Check"}},{"config":{"position":[13,921]},"moduleId":3,"name":"TASK : Access Approval","value":{"mitigatingControlRisk":[],"name":"Entitlement Owner Level 2","nottemplate1":"KHC-AccessRequest-ApprovalNotify","nottemplate2":"Select Email Template","reminderdate1":"2 minutes","remindertemplate1":"KHC-AccessRequest-ApprovalNotify-Reminder","typeofapproval":"Any Owner Approval Required","whomtosendrequest":"Owner Having Rank1"}},{"config":{"position":[-1,1320]},"moduleId":4,"name":"CONDITION : If Else","value":{"Condition":"((entitlement!= null and entitlement.risk > 3) and (entitlement.getOwnerRank2().contains(manager.username) == false))","explang":"groovy","name":"Check2"}},{"config":{"position":[581,1633]},"moduleId":5,"name":"TASK : Access Approval","value":{"mitigatingControlRisk":[],"name":"Entitlement Owner Level 3","nottemplate1":"KHC-AccessRequest-ApprovalNotify","nottemplate2":"Select Email Template","reminderdate1":"2 minutes","remindertemplate1":"KHC-AccessRequest-ApprovalNotify-Reminder","typeofapproval":"Any Owner Approval Required","whomtosendrequest":"Owner Having Rank2"}},{"config":{"position":[82,2250]},"moduleId":6,"name":"Activity : Grant Access","value":{"comptemplate1":"KHC-AccessRequest-Approved","name":"Approved Access"}},{"config":{"position":[526,2249]},"moduleId":7,"name":"Activity : Rejected Access","value":{"comptemplate1":"KHC-AccessRequest-Rejected","name":"Rejected Access"}},{"config":{"position":[330,2413]},"moduleId":8,"name":"End","value":{}},{"config":{"position":[410,88]},"moduleId":9,"name":"CONDITION : If Else","value":{"Condition":"((entitlement!= null and entitlement.risk > 2) and (entitlement.getOwnerRank1() == null or entitlement.getOwnerRank1().size() == 0 ))","explang":"groovy","name":"fallbackcheckRank1"}},{"config":{"position":[423,655]},"moduleId":10,"name":"TASK : Custom Assignment","value":{"allorany":"Any Owner Approval Required","mitigatingControlRisk":[],"name":"FallBack Approval Level2","nottemplate1":"KHC-AccessRequest-ApprovalNotify","nottemplate2":"Select Email Template","reminderdate1":"2 minutes","remindertemplate1":"KHC-AccessRequest-ApprovalNotify-Reminder","typeofapproval":"UserGroup","usergroupname":"FallBack Approver Level2:ADLogicalApps"}},{"config":{"position":[434,1305]},"moduleId":11,"name":"CONDITION : If Else","value":{"Condition":"((entitlement!= null and entitlement.risk > 3) and (entitlement.getOwnerRank2() == null or entitlement.getOwnerRank2().size() == 0 ))","explang":"groovy","name":"fallbackcheckRank2"}},{"config":{"position":[30,1591]},"moduleId":12,"name":"TASK : Custom Assignment","value":{"allorany":"Any Owner Approval Required","mitigatingControlRisk":[],"name":"FallBack Approval Level3","nottemplate1":"KHC-AccessRequest-ApprovalNotify","nottemplate2":"Select Email Template","reminderdate1":"2 minutes","remindertemplate1":"KHC-AccessRequest-ApprovalNotify-Reminder","typeofapproval":"UserGroup","usergroupname":"FallBack Approver Level3:ADLogicalApps"}},{"config":{"position":[7,427]},"moduleId":13,"name":"CONDITION : If Else","value":{"Condition":"entitlement != null","explang":"groovy","name":"checkAccountTask"}},{"config":{"position":[442,442]},"moduleId":14,"name":"Escalation","value":{"daysminute":"days","daysnumber":"7","name":"RejectRequest"}},{"config":{"position":[612,1177]},"moduleId":15,"name":"Escalation","value":{"daysminute":"days","daysnumber":"3","name":"RejectRequest1"}},{"config":{"position":[12,2038]},"moduleId":16,"name":"Escalation","value":{"daysminute":"days","daysnumber":"3","name":"RejectRequest3"}},{"config":{"position":[543,1040]},"moduleId":17,"name":"Escalation","value":{"daysminute":"days","daysnumber":"3","name":"RejectRequest2"}},{"config":{"position":[621,2072]},"moduleId":18,"name":"Escalation","value":{"daysminute":"days","daysnumber":"3","name":"RejectRequest4"}}],"properties":{"name":"RiskBased-Approval-WithEscalation1","wftype":"Parallel"},"wires":[{"src":{"moduleId":0,"terminal":"Requested"},"tgt":{"moduleId":1,"terminal":"SOURCES"}},{"src":{"moduleId":2,"terminal":"True"},"tgt":{"moduleId":3,"terminal":"SOURCES"}},{"src":{"moduleId":4,"terminal":"True"},"tgt":{"moduleId":5,"terminal":"SOURCES"}},{"src":{"moduleId":6,"terminal":"FOLLOWUPS"},"tgt":{"moduleId":8,"terminal":"SOURCES"}},{"src":{"moduleId":7,"terminal":"FOLLOWUPS"},"tgt":{"moduleId":8,"terminal":"SOURCES"}},{"src":{"moduleId":5,"terminal":"Access Approved"},"tgt":{"moduleId":6,"terminal":"SOURCES"}},{"src":{"moduleId":5,"terminal":"Access Rejected"},"tgt":{"moduleId":7,"terminal":"SOURCES"}},{"src":{"moduleId":4,"terminal":"False"},"tgt":{"moduleId":6,"terminal":"SOURCES"}},{"src":{"moduleId":3,"terminal":"Access Rejected"},"tgt":{"moduleId":7,"terminal":"SOURCES"}},{"src":{"moduleId":1,"terminal":"Rejected"},"tgt":{"moduleId":7,"terminal":"SOURCES"}},{"src":{"moduleId":9,"terminal":"False"},"tgt":{"moduleId":2,"terminal":"SOURCES"}},{"src":{"moduleId":9,"terminal":"True"},"tgt":{"moduleId":10,"terminal":"SOURCES"}},{"src":{"moduleId":10,"terminal":"Rejected"},"tgt":{"moduleId":7,"terminal":"SOURCES"}},{"src":{"moduleId":3,"terminal":"Access Approved"},"tgt":{"moduleId":11,"terminal":"SOURCES"}},{"src":{"moduleId":10,"terminal":"Approved"},"tgt":{"moduleId":11,"terminal":"SOURCES"}},{"src":{"moduleId":2,"terminal":"False"},"tgt":{"moduleId":11,"terminal":"SOURCES"}},{"src":{"moduleId":11,"terminal":"False"},"tgt":{"moduleId":4,"terminal":"SOURCES"}},{"src":{"moduleId":11,"terminal":"True"},"tgt":{"moduleId":12,"terminal":"SOURCES"}},{"src":{"moduleId":12,"terminal":"Approved"},"tgt":{"moduleId":6,"terminal":"SOURCES"}},{"src":{"moduleId":12,"terminal":"Rejected"},"tgt":{"moduleId":7,"terminal":"SOURCES"}},{"src":{"moduleId":1,"terminal":"Approved"},"tgt":{"moduleId":13,"terminal":"SOURCES"}},{"src":{"moduleId":13,"terminal":"True"},"tgt":{"moduleId":9,"terminal":"SOURCES"}},{"src":{"moduleId":13,"terminal":"False"},"tgt":{"moduleId":6,"terminal":"SOURCES"}},{"src":{"moduleId":1,"terminal":"Escalation"},"tgt":{"moduleId":14,"terminal":"SOURCES"}},{"src":{"moduleId":14,"terminal":"FOLLOWUPS"},"tgt":{"moduleId":7,"terminal":"SOURCES"}},{"src":{"moduleId":3,"terminal":"Escalation"},"tgt":{"moduleId":15,"terminal":"SOURCES"}},{"src":{"moduleId":15,"terminal":"FOLLOWUPS"},"tgt":{"moduleId":7,"terminal":"SOURCES"}},{"src":{"moduleId":12,"terminal":"Escalation"},"tgt":{"moduleId":16,"terminal":"SOURCES"}},{"src":{"moduleId":16,"terminal":"FOLLOWUPS"},"tgt":{"moduleId":7,"terminal":"SOURCES"}},{"src":{"moduleId":10,"terminal":"Escalation"},"tgt":{"moduleId":17,"terminal":"SOURCES"}},{"src":{"moduleId":17,"terminal":"FOLLOWUPS"},"tgt":{"moduleId":7,"terminal":"SOURCES"}},{"src":{"moduleId":5,"terminal":"Escalation"},"tgt":{"moduleId":18,"terminal":"SOURCES"}},{"src":{"moduleId":18,"terminal":"FOLLOWUPS"},"tgt":{"moduleId":7,"terminal":"SOURCES"}}]},"CREATEDATE":"10-28-2024 01:33:05","COMMENTS":"","SOURCEID":"","WFNAME":"RiskBased-Approval-WithEscalation1","STATUS":"Active","DESCRIPTION":null,"WFLOADED":true,"SOURCE":"UI","UPDATEDATE":"10-28-2024 01:33:35","UPDATEDBY":"admin","FROMWORKFLOW":null,"WFVERSION":1,"CREATEDBY":"admin","WFTYPE":"Parallel","XMLDATA":"<?xml version="1.0" encoding="UTF-8"?>
<process key="RiskBased-Approval-WithEscalation1"
    name="RiskBased-Approval-WithEscalation1" xmlns="http://jbpm.org/4.4/jpdl">
    <start name="Start">
        <transition to="foreachAccessRequest"/>
    </start>
    <foreach in="#{RequestAccessKeys}" name="foreachAccessRequest" var="requestaccesskey">
        <transition to="Manager Approval Level 1"/>
    </foreach>
    <task name="Manager Approval Level 1">
        <assignment-handler class="com.saviynt.workflowmgt.managerAssignmentHandler">
            <field name="removeitemcf">
                <string value="true"/>
            </field>
            <field name="mitigatingControlRisk">
                <string value="[]"/>
            </field>
        </assignment-handler>
        <transition name="Esclated By Manager Approval Level 1" to="Rejected Access">
            <timer duedate="7 days"/>
        </transition>
        <transition name="Approved By Manager Approval Level 1" to="checkAccountTask"/>
        <transition name="Rejected By Manager Approval Level 1" to="Rejected Access"/>
        <on event="start">
            <event-listener class="com.saviynt.workflowmgt.JBPMTaskEventListner">
                <field name="msg">
                    <string value="KHC-AccessRequest-ApprovalNotify"/>
                </field>
            </event-listener>
        </on>
        <on event="end">
            <event-listener class="com.saviynt.workflowmgt.JBPMTaskEventListner">
                <field name="msg">
                    <string value="null"/>
                </field>
            </event-listener>
        </on>
        <reminder duedate="2 minutes">
            <text><![CDATA[
#{requestaccesskey}__KHC-AccessRequest-ApprovalNotify-Reminder__Manager Approval Level 1
 ]]></text>
        </reminder>
    </task>
    <decision name="Check">
        <transition to="Entitlement Owner Level 2">
            <condition
                expr="(((entitlementslist.get(requestaccesskey)!= null &amp;&amp; entitlementslist.get(requestaccesskey).risk > 2) &amp;&amp; (entitlementslist.get(requestaccesskey).getOwnerRank1().contains(manager.username) == false))) == true " lang="groovy"/>
        </transition>
        <transition to="fallbackcheckRank2">
            <condition
                expr="(((entitlementslist.get(requestaccesskey)!= null &amp;&amp; entitlementslist.get(requestaccesskey).risk > 2) &amp;&amp; (entitlementslist.get(requestaccesskey).getOwnerRank1().contains(manager.username) == false))) == false " lang="groovy"/>
        </transition>
    </decision>
    <task name="Entitlement Owner Level 2">
        <assignment-handler class="com.saviynt.workflowmgt.RoleOwnerAssignHandlerRank1ApprByOne">
            <field name="mitigatingControlRisk">
                <string value="[]"/>
            </field>
        </assignment-handler>
        <transition name="Esclated By Entitlement Owner Level 2" to="Rejected Access">
            <timer duedate="3 days"/>
        </transition>
        <on event="start">
            <event-listener class="com.saviynt.workflowmgt.JBPMTaskEventListner">
                <field name="msg">
                    <string value="KHC-AccessRequest-ApprovalNotify"/>
                </field>
            </event-listener>
        </on>
        <on event="end">
            <event-listener class="com.saviynt.workflowmgt.JBPMTaskEventListner">
                <field name="msg">
                    <string value="null"/>
                </field>
            </event-listener>
        </on>
        <reminder duedate="2 minutes">
            <text><![CDATA[
 #{requestaccesskey}__KHC-AccessRequest-ApprovalNotify-Reminder__Entitlement Owner Level 2
 ]]></text>
        </reminder>
        <transition name="Approved By Entitlement Owner Level 2" to="fallbackcheckRank2"/>
        <transition name="Rejected By Entitlement Owner Level 2" to="Rejected Access"/>
    </task>
    <decision name="Check2">
        <transition to="Entitlement Owner Level 3">
            <condition
                expr="(((entitlementslist.get(requestaccesskey)!= null &amp;&amp; entitlementslist.get(requestaccesskey).risk > 3) &amp;&amp; (entitlementslist.get(requestaccesskey).getOwnerRank2().contains(manager.username) == false))) == true " lang="groovy"/>
        </transition>
        <transition to="Approved Access">
            <condition
                expr="(((entitlementslist.get(requestaccesskey)!= null &amp;&amp; entitlementslist.get(requestaccesskey).risk > 3) &amp;&amp; (entitlementslist.get(requestaccesskey).getOwnerRank2().contains(manager.username) == false))) == false " lang="groovy"/>
        </transition>
    </decision>
    <task name="Entitlement Owner Level 3">
        <assignment-handler class="com.saviynt.workflowmgt.RoleOwnerAssignHandlerRank2ApprByOne">
            <field name="mitigatingControlRisk">
                <string value="[]"/>
            </field>
        </assignment-handler>
        <transition name="Esclated By Entitlement Owner Level 3" to="Rejected Access">
            <timer duedate="3 days"/>
        </transition>
        <on event="start">
            <event-listener class="com.saviynt.workflowmgt.JBPMTaskEventListner">
                <field name="msg">
                    <string value="KHC-AccessRequest-ApprovalNotify"/>
                </field>
            </event-listener>
        </on>
        <on event="end">
            <event-listener class="com.saviynt.workflowmgt.JBPMTaskEventListner">
                <field name="msg">
                    <string value="null"/>
                </field>
            </event-listener>
        </on>
        <reminder duedate="2 minutes">
            <text><![CDATA[
 #{requestaccesskey}__KHC-AccessRequest-ApprovalNotify-Reminder__Entitlement Owner Level 3
 ]]></text>
        </reminder>
        <transition name="Approved By Entitlement Owner Level 3" to="Approved Access"/>
        <transition name="Rejected By Entitlement Owner Level 3" to="Rejected Access"/>
    </task>
    <java class="com.saviynt.workflowmgt.grantaccess"
        method="createAccess" name="Approved Access">
        <arg>
            <object expr="#{requestaccesskey}"/>
        </arg>
        <arg>
            <object expr="KHC-AccessRequest-Approved___Approved Access"/>
        </arg>
        <transition to="All Approvals Complete Check"/>
    </java>
    <java class="com.saviynt.workflowmgt.rejectaccess"
        method="denyAccess" name="Rejected Access">
        <arg>
            <object expr="#{requestaccesskey}"/>
        </arg>
        <arg>
            <object expr="KHC-AccessRequest-Rejected___Rejected Access"/>
        </arg>
        <transition to="All Approvals Complete Check"/>
    </java>
    <decision name="fallbackcheckRank1">
        <transition to="FallBack Approval Level2">
            <condition
                expr="(((entitlementslist.get(requestaccesskey)!= null &amp;&amp; entitlementslist.get(requestaccesskey).risk > 2) &amp;&amp; (entitlementslist.get(requestaccesskey).getOwnerRank1() == null || entitlementslist.get(requestaccesskey).getOwnerRank1().size() == 0 ))) == true " lang="groovy"/>
        </transition>
        <transition to="Check">
            <condition
                expr="(((entitlementslist.get(requestaccesskey)!= null &amp;&amp; entitlementslist.get(requestaccesskey).risk > 2) &amp;&amp; (entitlementslist.get(requestaccesskey).getOwnerRank1() == null || entitlementslist.get(requestaccesskey).getOwnerRank1().size() == 0 ))) == false " lang="groovy"/>
        </transition>
    </decision>
    <task name="FallBack Approval Level2">
        <transition name="Esclated By FallBack Approval Level2" to="Rejected Access">
            <timer duedate="3 days"/>
        </transition>
        <assignment-handler class="com.saviynt.workflowmgt.ArsCustomAssignmentHandler">
            <field name="fieldname">
                <string value="UserGroup___FallBack Approver Level2:ADLogicalApps___Any Owner Approval Required"/>
            </field>
            <field name="mitigatingControlRisk">
                <string value="[]"/>
            </field>
        </assignment-handler>
        <transition name="Approved By FallBack Approval Level2" to="fallbackcheckRank2"/>
        <transition name="Rejected By FallBack Approval Level2" to="Rejected Access"/>
        <on event="start">
            <event-listener class="com.saviynt.workflowmgt.JBPMTaskEventListner">
                <field name="msg">
                    <string value="KHC-AccessRequest-ApprovalNotify"/>
                </field>
            </event-listener>
        </on>
        <on event="end">
            <event-listener class="com.saviynt.workflowmgt.JBPMTaskEventListner">
                <field name="msg">
                    <string value="null"/>
                </field>
            </event-listener>
        </on>
        <reminder duedate="2 minutes">
            <text><![CDATA[
#{requestaccesskey}__KHC-AccessRequest-ApprovalNotify-Reminder__FallBack Approval Level2
 ]]></text>
        </reminder>
    </task>
    <decision name="fallbackcheckRank2">
        <transition to="FallBack Approval Level3">
            <condition
                expr="(((entitlementslist.get(requestaccesskey)!= null &amp;&amp; entitlementslist.get(requestaccesskey).risk > 3) &amp;&amp; (entitlementslist.get(requestaccesskey).getOwnerRank2() == null || entitlementslist.get(requestaccesskey).getOwnerRank2().size() == 0 ))) == true " lang="groovy"/>
        </transition>
        <transition to="Check2">
            <condition
                expr="(((entitlementslist.get(requestaccesskey)!= null &amp;&amp; entitlementslist.get(requestaccesskey).risk > 3) &amp;&amp; (entitlementslist.get(requestaccesskey).getOwnerRank2() == null || entitlementslist.get(requestaccesskey).getOwnerRank2().size() == 0 ))) == false " lang="groovy"/>
        </transition>
    </decision>
    <task name="FallBack Approval Level3">
        <transition name="Esclated By FallBack Approval Level3" to="Rejected Access">
            <timer duedate="3 days"/>
        </transition>
        <assignment-handler class="com.saviynt.workflowmgt.ArsCustomAssignmentHandler">
            <field name="fieldname">
                <string value="UserGroup___FallBack Approver Level3:ADLogicalApps___Any Owner Approval Required"/>
            </field>
            <field name="mitigatingControlRisk">
                <string value="[]"/>
            </field>
        </assignment-handler>
        <transition name="Approved By FallBack Approval Level3" to="Approved Access"/>
        <transition name="Rejected By FallBack Approval Level3" to="Rejected Access"/>
        <on event="start">
            <event-listener class="com.saviynt.workflowmgt.JBPMTaskEventListner">
                <field name="msg">
                    <string value="KHC-AccessRequest-ApprovalNotify"/>
                </field>
            </event-listener>
        </on>
        <on event="end">
            <event-listener class="com.saviynt.workflowmgt.JBPMTaskEventListner">
                <field name="msg">
                    <string value="null"/>
                </field>
            </event-listener>
        </on>
        <reminder duedate="2 minutes">
            <text><![CDATA[
#{requestaccesskey}__KHC-AccessRequest-ApprovalNotify-Reminder__FallBack Approval Level3
 ]]></text>
        </reminder>
    </task>
    <decision name="checkAccountTask">
        <transition to="fallbackcheckRank1">
            <condition
                expr="(entitlementslist.get(requestaccesskey) != null) == true " lang="groovy"/>
        </transition>
        <transition to="Approved Access">
            <condition
                expr="(entitlementslist.get(requestaccesskey) != null) == false " lang="groovy"/>
        </transition>
    </decision>
    <join multiplicity="#{quorum}" name="All Approvals Complete Check">
        <transition to="End Request"/>
    </join>
    <java class="com.saviynt.workflowmgt.endrequest"
        method="arsendrequest" name="End Request">
        <arg>
            <object expr="#{reqid}"/>
        </arg>
        <transition to="endRequest"/>
    </java>
    <end name="endRequest"/>
</process>
"}